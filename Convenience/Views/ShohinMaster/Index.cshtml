@using static Convenience.Models.Services.ShohinMasterService
@model Convenience.Models.ViewModels.ShohinMaster.ShohinMasterViewModel
@{
    ViewData["Title"] = "商品マスタ";

    IList<PostMasterData>? postMasterDatas = Model.PostMasterDatas as IList<PostMasterData>;
}

<h2>@ViewData["Title"]</h2>

<div class="container">
    <div class="form-group">
        <form asp-action="Index" id="need-collapse-at-retrival">
            <div asp-validation-summary="ModelOnly" class="text-danger">
            </div>
            @if (postMasterDatas.Count > 0) {
                <div class="list-group mt-1">
                    <table class="table table-striped table-bordered">
                        <thead class="table-primary">
                            <tr>
                                <th class="col-sm-2">
                                    <label asp-for="@postMasterDatas.FirstOrDefault()!.ShohinId" class="control-label"></label>
                                </th>
                                <th class="col-sm-2">
                                    <label asp-for="@postMasterDatas.FirstOrDefault()!.ShohinName" class="control-label"></label>
                                </th>
                                <th class="col-sm-2 text-end">
                                    <label asp-for="@postMasterDatas.FirstOrDefault()!.ShohinTanka" class="control-label"></label>
                                </th>
                                <th class="col-sm-2 text-end">
                                    <label asp-for="@postMasterDatas.FirstOrDefault()!.ShohiZeiritsu" class="control-label"></label>
                                </th>
                                <th class="col-sm-2 text-end">
                                    <label asp-for="@postMasterDatas.FirstOrDefault()!.ShohiZeiritsuEatIn" class="control-label"></label>
                                </th>
                                <th class="col-sm-1 text-center">
                                    <label asp-for="@postMasterDatas.FirstOrDefault()!.DeleteFlag" class="control-label"></label>
                                </th>
                                <th class="col-sm-1 text-center">
                                    追加
                                </th>

                            </tr>
                        </thead>

                        <tbody>
                            @for(int i=0 ;i < Model.PostMasterDatas.Count; i++) {
                                <tr>
                                    <td>
                                        <input asp-for="@postMasterDatas[i].ShohinId" class="form-control" />
                                        <span asp-validation-for="@postMasterDatas[i].ShohinId" class="text-danger"></span>
                                    </td>
                                    <td>
                                        <input asp-for="@postMasterDatas[i].ShohinName" class="form-control" />
                                        <span asp-validation-for="@postMasterDatas[i].ShohinName" class="text-danger"></span>
                                    </td>
                                    <td>
                                        <input asp-for="@postMasterDatas[i].ShohinTanka" class="form-control text-end" />
                                        <span asp-validation-for="@postMasterDatas[i].ShohinTanka" class="text-danger"></span>
                                    </td>
                                    <td>
                                        <input asp-for="@postMasterDatas[i].ShohiZeiritsu" class="form-control text-end" />
                                        <span asp-validation-for="@postMasterDatas[i].ShohiZeiritsu" class="text-danger"></span>
                                    </td>
                                    <td>
                                        <input asp-for="@postMasterDatas[i].ShohiZeiritsuEatIn" class="form-control text-end" />
                                        <span asp-validation-for="@postMasterDatas[i].ShohiZeiritsuEatIn" class="text-danger"></span>
                                    </td>
                                    <td class="text-center">
                                        <input asp-for="@postMasterDatas[i].DeleteFlag" type="checkbox" class="form-check-input" />
                                        <span asp-validation-for="@postMasterDatas[i].DeleteFlag" class="text-danger"></span>
                                    </td>
                                    <td class="text-center">
                                        <a href="@Url.Action("InsertRow", "ShohinMaster", new { index = i })" class="btn btn-primary btn-sm">挿入</a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            <input id="submit_btn_for_retrival" type="submit" value="更新" class="btn btn-primary" />
        </form>
    </div>
    <p>
        <div id="remark" class="@(Model.IsNormal??true ? "text-primary" : "text-danger")">
            <b>@Model.Remark</b>
        </div>
    </p>
</div>

<!-- 初期表示か・更新後の再表示か-->
<div id="handlingFlg" data-message="@ViewBag.HandlingFlg"></div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script src="~/js/sites.js"></script>
    <script>
        $(document).ready(function () {
            //AccordionHandller();
            RendaSolution();
            //GetShohinName();
            FirstFocus('@ViewBag.FocusPosition');
            //ResetForm("need-collapse-at-retrival");
            //PreventModoru();
        });
    </script>
}

